\documentclass[8pt]{beamer}
\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usetheme{Warsaw}
\useoutertheme{infolines} 
\setbeamertemplate{items}[ball]
\usepackage{algorithm}
\usepackage{fancybox}
\usepackage{hyperref}
\usepackage{tikz}
\usetikzlibrary{automata,calc,er}
\usetikzlibrary{mindmap,scopes,arrows,arrows.meta,shapes,chains,positioning,fit,backgrounds,decorations,intersections,petri,decorations.pathmorphing}
\usepackage{pgf}
\usepackage{pgfplots}
\pgfplotsset{compat=1.13}
\usetikzlibrary{pgfplots.fillbetween}
\pgfdeclarelayer{ft}
\pgfdeclarelayer{bg}
\pgfsetlayers{bg,main,ft}
\usepackage{graphics}
\usepackage{amssymb}
\usepackage{adjustbox}
\usepackage{wasysym}
\usepackage{siunitx}
\usepackage{makecell}
\usepackage{kbordermatrix}
\usepackage{mathtools}

\usepackage{calc}
\usepackage{fp}
\input{macros}
\input{macros-ph}
\input{macros-abstr}
\input{tikzstyles2}
\usepackage{cancel}
\newcommand{\highlight}[1]{\textcolor{blue!50}{\textbf{#1}}}
\title[Reachability Analysis and Revision of Dynamics]{Reachability Analysis and Revision of Dynamics of\\ Biological Regulatory Networks}
\author[X.Chai]{Xinwei Chai}
\institute[LS2N]{
Le Laboratoire des Sciences du Numérique de Nantes\\
École Centrale de Nantes\\
\texttt{xinwei.chai@ls2n.fr}

\vspace{1cm}
\input{tab_titlepage.tex}
}
\date[May 24, 2019]{May 24, 2019}
\begin{document}

\begin{frame}[plain]
  \titlepage
\end{frame}

\begin{frame}{Positioning of Our Work}
\begin{adjustbox}{max totalsize={.9\textwidth}{.9\textheight},center}
    \centering
    \input{figures/overview.tex}
\end{adjustbox}
\end{frame}

\begin{frame}{Biological Regulatory Networks}
    \input{figures/geneSchema.tex}
\end{frame}

\begin{frame}{Discrete Modeling}
\begin{columns}
\begin{column}{0.5\textwidth}
   \input{figures/sigmoidAndPiecewise.tex}
\end{column}
\begin{column}{0.5\textwidth}
\begin{itemize}
\item<+-> Behaviors of elements in BRN can be approximated by sigmoid functions
\item<+-> Simplified by piecewise functions with threshold.
When the concentration of $x$ is below the threshold, $x$ behaves as inhibition, otherwise promotion
\end{itemize}
\end{column}
\end{columns}
\end{frame}

\section{Motivation}
\begin{frame}{Problematic of Reachability Problem}
    \centering
    \input{figures/compare.tex}
\end{frame}

\begin{frame}{Challenge and Solution}
    \centering
    \input{figures/vennDiagram.tex}
    
    \vspace{0.5cm}
    \onslide<5>{$\to$ Apply heuristics on inconclusive area}
\end{frame}

\begin{frame}{Problematic of Model Inference}
    \centering
    \input{figures/problematic.tex}
\end{frame}

\begin{frame}{Reachability Problem Illustrated by Petri Nets}
    \centering
    \input{figures/automata.tex}
\end{frame}

\begin{frame}{Reachability Problem Illustrated by State Space}
Every system state is represented by a node in the digraph

    \vspace{0.2cm}
    {\centering
    \input{figures/reachability.tex}
    
    \vspace{0.2cm}
    $\alpha=$ initial state, $\omega=$ desired final state}
    
\end{frame}

\begin{frame}{Modeling System Dynamics}
    \begin{columns}
    \begin{column}{0.45\textwidth}
    Boolean Network (BN)
    
    \vspace{0.5cm}
    \includegraphics[width=\textwidth]{figures/BooleanNetwork.png}
    \end{column}
    \pause
    \begin{column}{0.45\textwidth}
    A modeling framework representing state transitions and using $O(n)$ memory $\to$ Automata Network (AN)
    
    \pause
    \vspace{0.5cm}
    \input{figures/BNtoAN.tex}
    
    \onslide<3->{The reachability of $(x,y,z)$ is of $O(2^n)$ $\Longrightarrow$}
    
    \onslide<4->{The reachability of $x$ can be of $O(n)$}
    
    \onslide<5->{$\Longrightarrow$ Local Causality Graph}
    \end{column}
    \end{columns}
\end{frame}

\begin{frame}{Local Causality Graph}
\input{figures/ANexample.tex}

\input{figures/LCGexampleAN.tex}

\only<1-5>{Small circles stand for transition nodes, squares for state nodes}
\begin{columns}
\begin{column}{0.5\textwidth}
\begin{align*}
    \only<6->{r'(a_1)&=r'(e_1)\lor (r'(b_1)\land r'(c_1)\\}
    \only<7->{&=r'(d_0)\land r'(c_1)\\}
    \only<8->{&=r'(d_0)\land r'(d_1)\\}
    \only<9->{&=r'(d_1)\\}
    \only<10->{&=r'(b_1)=r'(d_0)=1}
\end{align*}
\end{column}
\begin{column}{0.5\textwidth}
    \only<15>{However, $r'(a_i)$ is \highlight{not equivalent} to the reachability of $a_1$}
\end{column}
\end{columns}
\end{frame}

\begin{frame}{Counterexample of LCG}
LCG is \highlight{exact} for unreachability 

LCG is \highlight{exact} when it does not contain self-dependent structure:
\begin{itemize}
\item different state nodes of the same automaton in different branches:
\end{itemize}
Given initial state: $a_0,b_0,c_0$, consider the reachability of $c_1$:

\begin{columns}
\begin{column}{0.45\textwidth}
    \input{figures/AN_limitation.tex}
\end{column}
\begin{column}{0.55\textwidth}
    \input{figures/LCG_limitation.tex}
\end{column}
\end{columns}

\only<1>{Reaching $a_1$ disables the reachability of $b_1$, and vice versa, $c_1$ is unreachable}
\only<2->{$c_1$ is reachable \textit{via} $a_1::b_1::c_1$}

\only<3->{
\begin{columns}
\begin{column}{0.5\textwidth}
LCG does not show \highlight{orders} of local states

\centering
$\Longrightarrow$ How to deal with this structure?
\end{column}
\begin{column}{0.5\textwidth}
\input{figures/inconcStructure.tex}
\end{column}
\end{columns}
}
\end{frame}

\begin{frame}{Two Possible Heuristics}
    Complete search \pause $\to$ State space explosion problem $\times$ \pause $\to$ Partial search
    
    \vspace{0.5cm}
    \pause     
\begin{columns}
\begin{column}{0.5\textwidth}
$\to$ Heuristics used to find a sequence of local states in the form $Z::Y::X$
\end{column}
\begin{column}{0.5\textwidth}
\centering
\input{figures/inconcStructure.tex}
\end{column}
\end{columns}

\vspace{0.5cm}
\pause     
\centering
    \begin{tabular}{c|c|c}
        &PermReach & ASPReach \\
        \hline
        Method &\makecell{Search all the \\permutations of branches}   &\makecell{Search all the possible\\ order of branches}\\
        \hline
        Runtime & $+$ & $-$ \\
        Conclusiveness& $-$&$+$
    \end{tabular}
     
\end{frame}

\begin{frame}{Example}
\begin{columns}
\begin{column}{0.45\textwidth}
    \input{figures/AN_limitation.tex}
\end{column}
\begin{column}{0.55\textwidth}
    \input{figures/LCG_limitation.tex}
\end{column}
\end{columns}

\vspace{0.5cm}
Notation: $a\rhd b$ means $a$ appears in the sequence before $b$

\only<1>{
\begin{tabular}{lll}
Order constraints in LCG &$\Rightarrow$& $b_0\rhd a_1\rhd c_1$ , $a_0 \rhd b_1\rhd c_1$\\
Additional rule &$\Rightarrow$& $a_1 \rhd b_1$ and $b_1 \rhd a_1$
\end{tabular}

\vspace{0.5cm}
Contradiction in order, no solution
}

\only<2>{
\begin{tabular}{lll}
Order constraints in LCG &$\Rightarrow$& $b_0\rhd a_1\rhd c_1$ , $c_0 \rhd b_1\rhd c_1$\\
Additional rule &$\Rightarrow$& $a_1 \rhd b_1$
\end{tabular}

\vspace{0.5cm}
The only admissible order is $a_1\to b_1\to c_1$}
\end{frame}

\begin{frame}{Benchmarks: on Biological Examples}
Traditional model checkers: Mole NuSMV $\to$ \highlight{memory-out}

Pure static analyzer: Pint% \cite{folschette2015}

Small example: $\lambda$-phage, 4 components

Big examples: TCR (T-Cell Receptor, 95 components) and

EGFR (Epidermal Growth Factor Receptor, 106 components)

\small
    \centering
    \input{tab_benchmark.tex}
\end{frame}

\begin{frame}{Benchmarks: on Random Examples}
\input{figures/curveSizeTest.tex}
\input{figures/curveInconc.tex}
\end{frame}

\begin{frame}{Second Part: Learning and Revising Models}
    \input{figures/problematicRevision.tex}

    \vspace{0.2cm}
    \begin{itemize}
    \item<+-> CRAC: Completion \textit{via} Reachability And Correlations
    \item<+-> M2RIT: Model Revision \textit{via} Reachability and Interpretation Transitions
\end{itemize}
\onslide<+->{
    \begin{tabular}{c|c|c}
         &CRAC & M2RIT \\
         \hline
         Learning phase & Correlation Coefficients & LFIT\\
         \hline
         Revising phase & \makecell{Reachability+\\candidate transitions} & \makecell{Reachability+\\time-series data}\\
         \hline
         Data type &Continuous & Discrete\\
         \hline
         Function &Inference & Precise learning\\
         \hline
         \makecell{Tolerance to\\ imprecision}&Yes&No
    \end{tabular}
}
\end{frame}

\begin{frame}{Learning Phase}
CRAC:

\vspace{0.2cm}
\begin{columns}
\begin{column}{0.5\textwidth}
\onslide<1->{
1.
\begin{tabular}{l|*{4}{l}}
$t$&0&1&2&3\\
\hline
$a$&2.01&2.51&1.97&1.17\\
$b$&0.74&0.87&0.78&0.33\\
\end{tabular} 
}

\onslide<3->{
3.
$r'=\kbordermatrix{\mbox{}&\Delta a&\Delta b\\
a&\text{N/A}&0.09\\
b&0.65&\text{N/A}\\
}$
}
\end{column}
\begin{column}{0.5\textwidth}
\onslide<2->{
2.
\begin{tabular}{c|c*{3}{S}}
$t$&1&2&3\\
\hline
$\Delta a$&0.5&-0.54&-0.8\\
$\Delta b$&0.13&-0.09&-0.45\\
\end{tabular}
}

\onslide<4->{
\begin{tikzpicture}[grn]
      \path[use as bounding box] (-0.3,-0.75) rectangle (4,.75);
      \node[inner sep=0] (b) at (2,0) {b};
      \node[inner sep=0] (a) at (0,0) {a};
      \node[draw=none] (lab) at (-0.6,0) {4.};    
      \path[->]
       (b) edge[bend right] node[elabel, above=-5pt] {} (a);
\end{tikzpicture}
}
\end{column}
\end{columns}

\vspace{0.5cm}
\onslide<5->{
M2RIT:

\vspace{0.2cm}
\begin{columns}
\begin{column}{0.4\textwidth}
Full transitions

$(a(t),b(t))\gets (a(t-1),b(t-1))$
\end{column}
\begin{column}{0.2\textwidth}
classed into

     $\Longrightarrow$ 
\end{column}
\begin{column}{0.4\textwidth}
    partial transitions
    
    $a_1\gets b_1$
\end{column}
\end{columns}
}
\end{frame}

\begin{frame}{Revising Phase}
    Methodology:
    
    \begin{center}
        \begin{tabular}{l|c|c}
        &Reachable &Unreachable\\
        \hline
        Knowledge& $R_K$ & $U_K$ \pause\\
        \hline
        Inferred model& $R_I$ & $U_I$\pause\\
        \hline
        Inconsistency (problem)& $R'_K=R_K\cap U_I$ & $U'_K=R_I\cap U_K$\pause\\
        Keep consistent with& $U_K$& $R_K$ \pause
    \end{tabular} 
    \end{center}
2 solutions:
\begin{itemize}
    \item General solution: cut set + completion set, complete but costly
    \item Heuristics, fast but not complete
\end{itemize}
\end{frame}

\begin{frame}{Cut Set}
    \input{figures/cutset.tex}
\begin{columns}
\begin{column}{0.65\textwidth}
    \input{tab_cutset.tex}
\end{column}
\begin{column}{0.35\textwidth}
    By inhibiting the reachability of one of the sets in cut set $\{\{a_1\},\{b_1\},\{b_0,c_1\},\{c_1,d_1\}\}$, $a_1$ shall not be reachable.
    
\vspace{0.2cm}
Modification depends on the consistency with the result of learning phase.
\end{column}
\end{columns}    
\end{frame}
 
\begin{frame}{Completion Set}
    \input{figures/completionSet.tex}
    
\vspace{0.5cm}    
\begin{columns}
\begin{column}{0.65\textwidth}
    \input{tab_completion_set.tex}
\end{column}
\begin{column}{0.35\textwidth}
By assuring the reachability of one of the sets in completion set $\{\{a_1\},\{b_1\},\{b_0,c_1\},\{c_1,d_1\}\}$, $a_1$ shall not be reachable.

\vspace{0.2cm}
Modification depends on the consistency with the result of learning phase.
\end{column}
\end{columns} 
\end{frame} 
 
\begin{frame}{Heuristics}
\begin{columns}
\begin{column}{0.6\textwidth}
\input{figures/AN_revision.tex}
\end{column}
\begin{column}{0.4\textwidth}
    $\alpha=\langle a_0,b_0,c_0,d_0\rangle$, $\omega=a_1$
    
	$U_K=\{(\alpha,b_1),(\alpha,d_1)\}$
	
	$R_K=\{(\alpha,a_1)\}$
\end{column}
\end{columns}

        \vspace{0.3cm}
        \centering
        \input{figures/revision.tex}
        
        \vspace{0.3cm}
     \begin{itemize}
        \item $L=\{\{(\alpha,a_1),(\alpha,b_1),(\alpha,d_1)\},\{(\alpha,b_1)\},\{(\alpha,d_1)\}\}$
        \item Start from $\{(\alpha,b_1)\}$ and $\{(\alpha,d_1)\}$
        \item $b_1\gets c_0$ can be specialized to $b_1\gets c_0\land a_1$ to make $b_1$ unreachable
        \item $a_1\gets d_1 \land c_0$ can only be generalized to $a_1 \gets c_0$ as $d_1\in U_K$
        \item Check the reachability of $(\alpha,a_1)$: reachable, finish
    \end{itemize}
\end{frame}

\begin{frame}{Conclusion}
\begin{itemize}
    \item Reachability Analysis
    \begin{itemize}
        \item PermReach and ASPReach: faster than traditional model checkers and more conclusive than pure static analysis $\to$ balance between complexity and completeness
        \item Deal with systems with up to $10^3$ automata
        \item $\xRightarrow{\text{?}}$ Hybrid analyzer is more performing in reachability analysis
    \end{itemize}
    \item Model Learning and Revision
    \begin{itemize}
        \item A comparatively new domain
        \item By only heuristics as metrics, only systems bisimilar to original systems
        \item General solution vs. heuristics $\to$ balance between complexity and completeness
        \item More information needed to obtain a precise model 
    \end{itemize}
\end{itemize}
\end{frame}

%\begin{frame}{Bibliography}
%    \bibliographystyle{plain}
%    \bibliography{bib}
%\end{frame}
\end{document}